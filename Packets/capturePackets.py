from scapy.all import *;

file = sys.argv[1];
packets = rdpcap(file);

# print only the raw part of the ICMP packet
#print(packets[1][Raw]);

# print only the ICMP part of the ICMP packet with extra info (ls)
#print(ls(packets[0][ICMP]));

# print the last 16 characters of the packet, with packets that send 2 bytes at a time, use -4
#print(packets[1][Raw].load[-16:]);


for packet in packets:
	print(packet.load[-4:]);
##


# check if it's actually ICMP
#if packets[0].haslayer(ICMP):
#	print("true");
##


