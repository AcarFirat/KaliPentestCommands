from scapy.all import *;

def processPacket(packet):
    if packet.haslayer(ICMP):
        if packet[ICMP].type == 8: # make sure it's the request packet
            packetData = packet[ICMP].load[-4:]
                print(packetData.decode("utf-8"), flush=True, end='');
                #print(f'{packetData.decode("utf-8")}', flush=True, end='');
        ##
    ##

##


# on every sniff, it does 'processPacket'
sniff(iface='tun0', prn=processPacket);
