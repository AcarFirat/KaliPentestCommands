#!/usr/bin/python3
# A script that takes a non-binary (preferably base64) file and converts it to one string in VBS
import sys
import re

if len(sys.argv) != 3:
    print(f'Usage: python3 {sys.argv[0]} inFile outFile')
    exit(0)
##

global splitLines
inFile = sys.argv[1]
outFile = sys.argv[2]

# Read the payload file and split into an array of strings
with open(inFile, "rb") as f:
    for line in f:
        splitLines = re.findall(".{1,170}", line.decode())
    ##
##

# String variable name for vbs macro
varName = "XIJsUAJU"
with open(outFile, "w+") as f:
    f.write(f"Dim {varName} as String\n")
    f.write(f"{varName} = \"\"\n")
    for line in splitLines:
        f.write(f"{varName} = {varName} & \"{line}\"\n")
    ##
##
